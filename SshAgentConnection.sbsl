#required IO.sbsl

@Global
method Open(
    User: String,
    Password: String,
    Address: String = "localhost",
    Port: Number = 1543): SshConnection
    return new SshConnection(Address, Port, User, Password)
;

@Global
method ConnectIB(Connection: SshConnection)
    Connection.Execute("common connect-ib")
;

@Global
method UploadConfiguration(Connection: SshConnection, ConfigFilePath: String)
    Connection.Execute("config dump-config-to-files --dir=\".\" --list-file=\"${ConfigFilePath}\"")
;

@Global
method LoadFile(
    User: String,
    Password: String,
    FilePath: String,
    Address: String = "localhost",
    Port: Number = 1543)
    use Ssh = new SshConnection(Address, Port, User, Password)
    use Sftp = Ssh.OpenSftpConnection()

    Sftp.SetCurrentDirectory("/")
    Sftp.Put(FilePath)
    Sftp.Close()
;

@Global
method DisconnectIB(Connection: SshConnection)
    Connection.Execute("common diconnect-ib")
;

@Global
method Shutdown(Connection: SshConnection)
    Connection.Execute("common shutdown")
;

@Global
method Close(Connection: SshConnection)
    Connection.Close()
;